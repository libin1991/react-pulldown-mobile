{"version":3,"sources":["../src/index.jsx"],"names":["PullDown","props","state","offset","pulling","__container","__eventType","__self","__lastPageY","__threshold","document","querySelector","container","refs","content","parentNode","threshold","__sensitivity","sensitivity","__enablePull","enablePull","__enablePush","enablePush","className","class","id","e","handleTouchStart","handleTouchMove","handleTouchEnd","minHeight","WebkitTransition","WebkitTransform","transition","transform","topTip","tip","bottomTip","children","onPullCancel","onPullDown","onPushCancel","onPushUp","containerHeight","getBoundingClientRect","height","contentHeight","scrollTop","scrollBottom","touches","pageY","setState","Math","abs","handlePushCancel","handlePullCancel","handlePushUp","handlePullDown","preventDefault","onPullMove","onPushMove","Component"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;;;IAEMA,Q;;;AAEJ,oBAAYC,KAAZ,EAAmB;AAAA;;AAAA,oHAEXA,KAFW;;AAGjB,UAAKC,KAAL,GAAa;AACXC,cAAQ,CADG;AAEXC,eAAS;AAFE,KAAb;;AAKA,UAAKC,WAAL,GAAmB,IAAnB;AACA,UAAKC,WAAL,GAAmB,IAAnB;AACA,UAAKC,MAAL,GAAc,IAAd;AACA,UAAKC,WAAL,GAAmB,CAAnB;AACA,UAAKC,WAAL,GAAmB,CAAnB;;AAZiB;AAclB;;;;wCAEmB;;AAElB,WAAKJ,WAAL,GAAmBK,SAASC,aAAT,CAAuB,KAAKV,KAAL,CAAWW,SAAlC,KAAgD,KAAKC,IAAL,CAAUC,OAAV,CAAkBC,UAArF;AACA,WAAKR,MAAL,GAAc,KAAKM,IAAL,CAAUC,OAAxB;AACA,WAAKL,WAAL,GAAmB,KAAKR,KAAL,CAAWe,SAAX,IAAwB,GAA3C;AACA,WAAKC,aAAL,GAAqB,KAAKhB,KAAL,CAAWiB,WAAX,IAA0B,EAA/C;AACA,WAAKC,YAAL,GAAoB,OAAO,KAAKlB,KAAL,CAAWmB,UAAlB,KAAiC,SAAjC,GAA6C,KAAKnB,KAAL,CAAWmB,UAAxD,GAAqE,IAAzF;AACA,WAAKC,YAAL,GAAoB,OAAO,KAAKpB,KAAL,CAAWqB,UAAlB,KAAiC,SAAjC,GAA6C,KAAKrB,KAAL,CAAWqB,UAAxD,GAAqE,IAAzF;AAED;;;6BAEQ;AAAA;;AAEP,UAAIC,YAAY,KAAKtB,KAAL,CAAWsB,SAAX,IAAwB,KAAKtB,KAAL,CAAWuB,KAAnD;;AAEA,aACE;AAAA;AAAA;AACE,eAAI,SADN;AAEE,cAAI,KAAKvB,KAAL,CAAWwB,EAAX,IAAiB,gBAFvB;AAGE,qBAAW,oBAAoBF,SAHjC;AAIE,wBAAc,sBAACG,CAAD;AAAA,mBAAO,OAAKC,gBAAL,CAAsBD,CAAtB,CAAP;AAAA,WAJhB;AAKE,uBAAa,qBAACA,CAAD;AAAA,mBAAO,OAAKE,eAAL,CAAqBF,CAArB,CAAP;AAAA,WALf;AAME,sBAAY,oBAACA,CAAD;AAAA,mBAAO,OAAKG,cAAL,CAAoBH,CAApB,CAAP;AAAA,WANd;AAOE,iBAAO;AACLI,uBAAW,KAAK7B,KAAL,CAAW6B,SAAX,IAAwB,MAD9B;AAELC,8BAAkB,KAAK7B,KAAL,CAAWE,OAAX,GAAqB,MAArB,GAA8B,eAF3C;AAGL4B,6BAAiB,8BAA8B,KAAK9B,KAAL,CAAWC,MAAX,IAAqB,IAAI,KAAKc,aAA9B,CAA9B,GAA6E,KAHzF;AAILgB,wBAAY,KAAK/B,KAAL,CAAWE,OAAX,GAAqB,MAArB,GAA8B,eAJrC;AAKL8B,uBAAW,+BAA+B,KAAKhC,KAAL,CAAWC,MAAX,IAAqB,IAAI,KAAKc,aAA9B,CAA/B,GAA8E;AALpF;AAPT;AAeI;AAAA;AAAA,YAAK,WAAU,iCAAf;AACE;AAAA;AAAA,cAAK,WAAU,wBAAf;AAAyC,iBAAKhB,KAAL,CAAWkC,MAAX,IAAqB,KAAKlC,KAAL,CAAWmC;AAAzE,WADF;AAEE;AAAA;AAAA,cAAK,WAAU,2BAAf;AAA4C,iBAAKnC,KAAL,CAAWoC;AAAvD;AAFF,SAfJ;AAmBK,aAAKpC,KAAL,CAAWqC;AAnBhB,OADF;AAwBD;;;uCAEkB;;AAEjB,aAAO,KAAKrC,KAAL,CAAWsC,YAAlB,KAAmC,UAAnC,IAAiD,KAAKtC,KAAL,CAAWsC,YAAX,EAAjD;AAED;;;qCAEgB;;AAEf,aAAO,KAAKtC,KAAL,CAAWuC,UAAlB,KAAiC,UAAjC,IAA+C,KAAKvC,KAAL,CAAWuC,UAAX,EAA/C;AAED;;;uCAEkB;;AAEjB,aAAO,KAAKvC,KAAL,CAAWwC,YAAlB,KAAmC,UAAnC,IAAiD,KAAKxC,KAAL,CAAWwC,YAAX,EAAjD;AAED;;;mCAEc;;AAEb,aAAO,KAAKxC,KAAL,CAAWyC,QAAlB,KAA+B,UAA/B,IAA6C,KAAKzC,KAAL,CAAWyC,QAAX,EAA7C;AAED;;;qCAEgBhB,C,EAAG;;AAElB,UAAIiB,kBAAkB,KAAKtC,WAAL,CAAiBuC,qBAAjB,GAAyCC,MAA/D;AACA,UAAIC,gBAAgB,KAAKvC,MAAL,CAAYqC,qBAAZ,GAAoCC,MAAxD;AACA,UAAIE,YAAY,KAAK1C,WAAL,CAAiB0C,SAAjC;AACA,UAAIC,eAAeF,gBAAgBH,eAAhB,GAAkCI,SAArD;;AAEA,UAAI,CAACA,aAAa,CAAb,IAAkBC,gBAAgB,CAAnC,MAA0C,KAAK7B,YAAL,IAAqB,KAAKE,YAApE,CAAJ,EAAuF;;AAErF,aAAKb,WAAL,GAAmBkB,EAAEuB,OAAF,CAAU,CAAV,EAAaC,KAAhC;AACA,aAAKC,QAAL,CAAc;AACZ/C,mBAAS;AADG,SAAd;AAID;AAEF;;;qCAEgB;;AAEf,UAAIuC,kBAAkB,KAAKtC,WAAL,CAAiBuC,qBAAjB,GAAyCC,MAA/D;AACA,UAAIC,gBAAgB,KAAKvC,MAAL,CAAYqC,qBAAZ,GAAoCC,MAAxD;AACA,UAAIE,YAAY,KAAK1C,WAAL,CAAiB0C,SAAjC;AACA,UAAIC,eAAeF,gBAAgBH,eAAhB,GAAkCI,SAArD;;AAEA,UAAIA,aAAa,CAAb,IAAkBC,gBAAgB,CAAtC,EAAyC;;AAEvC,YAAII,KAAKC,GAAL,CAAS,KAAKnD,KAAL,CAAWC,MAApB,IAA8B,KAAKM,WAAvC,EAAoD;;AAElD,cAAI,KAAKP,KAAL,CAAWC,MAAX,GAAoB,CAAxB,EAA2B;AACzB,iBAAKmD,gBAAL;AACD,WAFD,MAEO,IAAG,KAAKpD,KAAL,CAAWC,MAAX,GAAoB,CAAvB,EAA0B;AAC/B,iBAAKoD,gBAAL;AACD,WAFM,MAEA;;AAEL,gBAAI,KAAKjD,WAAL,KAAqB,MAAzB,EAAiC;AAC/B,mBAAKiD,gBAAL;AACD,aAFD,MAEO,IAAI,KAAKjD,WAAL,KAAqB,MAAzB,EAAiC;AACtC,mBAAKgD,gBAAL;AACD;AAEF;AAEF,SAhBD,MAgBO;;AAEL,cAAI,KAAKpD,KAAL,CAAWC,MAAX,GAAoB,CAAxB,EAA2B;AACzB,iBAAKqD,YAAL;AACD,WAFD,MAEO;AACL,iBAAKC,cAAL;AACD;AAEF;;AAED,aAAKnD,WAAL,GAAmB,IAAnB;;AAEA,aAAK6C,QAAL,CAAc;AACZ/C,mBAAS,KADG;AAEZD,kBAAQ;AAFI,SAAd;AAKD;AAEF;;;oCAEeuB,C,EAAG;;AAEjB,UAAIiB,kBAAkB,KAAKtC,WAAL,CAAiBuC,qBAAjB,GAAyCC,MAA/D;AACA,UAAIC,gBAAgB,KAAKvC,MAAL,CAAYqC,qBAAZ,GAAoCC,MAAxD;AACA,UAAIE,YAAY,KAAK1C,WAAL,CAAiB0C,SAAjC;AACA,UAAIC,eAAeF,gBAAgBH,eAAhB,GAAkCI,SAArD;;AAEA,UAAIA,aAAa,CAAb,IAAkB,KAAK5B,YAA3B,EAAyC;;AAEvC,YAAIhB,SAASuB,EAAEuB,OAAF,CAAU,CAAV,EAAaC,KAAb,GAAqB,KAAK1C,WAAvC;AACAL,iBAAS,CAAT,KAAeA,SAAS,CAAxB;AACAA,iBAAS,KAAKM,WAAd,KAA8BN,SAAS,KAAKM,WAA5C;AACAN,iBAAS,CAAT,IAAeuB,EAAEgC,cAAF,EAAf;;AAEA,aAAKpD,WAAL,GAAmB,MAAnB;;AAEA,eAAO,KAAKL,KAAL,CAAW0D,UAAlB,KAAiC,UAAjC,IAA+C,KAAK1D,KAAL,CAAW0D,UAAX,CAAsB;AACnExD,kBAAQA,MAD2D;AAEnEa,qBAAW,KAAKP,WAFmD;AAGnES,uBAAa,KAAKD;AAHiD,SAAtB,CAA/C;;AAMA,aAAKkC,QAAL,CAAc,EAAEhD,cAAF,EAAd;AAED,OAjBD,MAiBO,IAAI6C,gBAAgB,CAAhB,IAAqB,KAAK3B,YAA9B,EAA4C;;AAEjD,YAAIlB,UAASuB,EAAEuB,OAAF,CAAU,CAAV,EAAaC,KAAb,GAAqB,KAAK1C,WAAvC;AACAL,kBAAS,CAAT,KAAeA,UAAS,CAAxB;AACAA,kBAAS,KAAKM,WAAL,GAAmB,CAAC,CAA7B,KAAmCN,UAAS,KAAKM,WAAL,GAAmB,CAAC,CAAhE;AACAN,kBAAS,CAAT,IAAeuB,EAAEgC,cAAF,EAAf;;AAEA,aAAKpD,WAAL,GAAmB,MAAnB;;AAEA,eAAO,KAAKL,KAAL,CAAW2D,UAAlB,KAAiC,UAAjC,IAA+C,KAAK3D,KAAL,CAAW2D,UAAX,CAAsB;AACnEzD,kBAAQA,OAD2D;AAEnEa,qBAAW,KAAKP,WAFmD;AAGnES,uBAAa,KAAKD;AAHiD,SAAtB,CAA/C;;AAMA,aAAKkC,QAAL,CAAc,EAAEhD,eAAF,EAAd;AAED;AAEF;;;;EA9LoB,gBAAM0D,S;;kBAkMd7D,Q","file":"index.js","sourcesContent":["import React from 'react'\nimport './index.css'\n\nclass PullDown extends React.Component{\n\n  constructor(props) {\n\n    super(props)\n    this.state = {\n      offset: 0,\n      pulling: false\n    }\n\n    this.__container = null\n    this.__eventType = null\n    this.__self = null\n    this.__lastPageY = 0\n    this.__threshold = 0\n\n  }\n\n  componentDidMount() {\n\n    this.__container = document.querySelector(this.props.container) || this.refs.content.parentNode\n    this.__self = this.refs.content\n    this.__threshold = this.props.threshold || 200\n    this.__sensitivity = this.props.sensitivity || .4\n    this.__enablePull = typeof this.props.enablePull === 'boolean' ? this.props.enablePull : true\n    this.__enablePush = typeof this.props.enablePush === 'boolean' ? this.props.enablePush : true\n\n  }\n\n  render() {\n\n    let className = this.props.className || this.props.class\n\n    return (\n      <div\n        ref=\"content\"\n        id={this.props.id || 'react-pulldown'}\n        className={'react-pulldown ' + className}\n        onTouchStart={(e) => this.handleTouchStart(e)}\n        onTouchMove={(e) => this.handleTouchMove(e)}\n        onTouchEnd={(e) => this.handleTouchEnd(e)}\n        style={{\n          minHeight: this.props.minHeight || '100%', \n          WebkitTransition: this.state.pulling ? 'none' : 'transform .3s',\n          WebkitTransform: 'translateZ(0) translateY(' + this.state.offset / (1 / this.__sensitivity) + 'px)',\n          transition: this.state.pulling ? 'none' : 'transform .3s',\n          transform: 'translateZ(0)  translateY(' + this.state.offset / (1 / this.__sensitivity) + 'px)'\n        }}\n        >\n          <div className=\"react-pulldown-background-layer\">\n            <div className=\"react-pulldown-top-tip\">{this.props.topTip || this.props.tip}</div>\n            <div className=\"react-pulldown-bottom-tip\">{this.props.bottomTip}</div>\n          </div>\n          {this.props.children}\n        </div>\n    )\n\n  }\n\n  handlePullCancel() {\n\n    typeof this.props.onPullCancel === 'function' && this.props.onPullCancel()\n\n  }\n\n  handlePullDown() {\n\n    typeof this.props.onPullDown === 'function' && this.props.onPullDown()\n\n  }\n\n  handlePushCancel() {\n\n    typeof this.props.onPushCancel === 'function' && this.props.onPushCancel()\n\n  }\n\n  handlePushUp() {\n\n    typeof this.props.onPushUp === 'function' && this.props.onPushUp()\n\n  }\n\n  handleTouchStart(e) {\n\n    let containerHeight = this.__container.getBoundingClientRect().height\n    let contentHeight = this.__self.getBoundingClientRect().height\n    let scrollTop = this.__container.scrollTop\n    let scrollBottom = contentHeight - containerHeight - scrollTop\n\n    if ((scrollTop <= 0 || scrollBottom <= 0) && (this.__enablePull || this.__enablePush)) {\n\n      this.__lastPageY = e.touches[0].pageY\n      this.setState({\n        pulling: true\n      })\n\n    }\n\n  }\n\n  handleTouchEnd() {\n\n    let containerHeight = this.__container.getBoundingClientRect().height\n    let contentHeight = this.__self.getBoundingClientRect().height\n    let scrollTop = this.__container.scrollTop\n    let scrollBottom = contentHeight - containerHeight - scrollTop\n\n    if (scrollTop <= 0 || scrollBottom <= 0) {\n\n      if (Math.abs(this.state.offset) < this.__threshold) {\n\n        if (this.state.offset < 0) {\n          this.handlePushCancel()\n        } else if(this.state.offset > 0) {\n          this.handlePullCancel()\n        } else {\n\n          if (this.__eventType === 'pull') {\n            this.handlePullCancel()\n          } else if (this.__eventType === 'push') {\n            this.handlePushCancel()\n          }\n\n        }\n\n      } else {\n\n        if (this.state.offset < 0) {\n          this.handlePushUp()\n        } else {\n          this.handlePullDown()\n        }\n\n      }\n\n      this.__eventType = null\n\n      this.setState({\n        pulling: false,\n        offset: 0\n      })\n\n    }\n\n  }\n\n  handleTouchMove(e) {\n\n    let containerHeight = this.__container.getBoundingClientRect().height\n    let contentHeight = this.__self.getBoundingClientRect().height\n    let scrollTop = this.__container.scrollTop\n    let scrollBottom = contentHeight - containerHeight - scrollTop\n\n    if (scrollTop <= 0 && this.__enablePull) {\n\n      let offset = e.touches[0].pageY - this.__lastPageY\n      offset < 0 && (offset = 0)\n      offset > this.__threshold && (offset = this.__threshold)\n      offset > 0 &&  e.preventDefault()\n\n      this.__eventType = 'pull'\n\n      typeof this.props.onPullMove === 'function' && this.props.onPullMove({\n        offset: offset,\n        threshold: this.__threshold,\n        sensitivity: this.__sensitivity\n      })\n\n      this.setState({ offset })\n\n    } else if (scrollBottom <= 0 && this.__enablePush) {\n\n      let offset = e.touches[0].pageY - this.__lastPageY\n      offset > 0 && (offset = 0)\n      offset < this.__threshold * -1 && (offset = this.__threshold * -1)\n      offset < 0 &&  e.preventDefault()\n\n      this.__eventType = 'push'\n\n      typeof this.props.onPushMove === 'function' && this.props.onPushMove({\n        offset: offset,\n        threshold: this.__threshold,\n        sensitivity: this.__sensitivity\n      })\n\n      this.setState({ offset })\n\n    }\n\n  }\n\n}\n\nexport default PullDown"]}