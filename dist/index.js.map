{"version":3,"sources":["../src/index.jsx"],"names":["PullDown","props","state","offset","pulling","__container","__self","__lastPageY","__threshold","document","querySelector","container","refs","content","parentNode","threshold","__sensitivity","sensitivity","id","class","e","handleTouchStart","handleTouchMove","handleTouchEnd","minHeight","WebkitTransition","WebkitTransform","transition","transform","tip","children","onPullCancel","onPullDown","containerHeight","getBoundingClientRect","height","contentHeight","scrollTop","scrollBottom","console","log","touches","pageY","setState","handlePullCancel","handlePullDown","preventDefault","onPullMove","Component"],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react'\nimport './index.css'\n\nclass PullDown extends React.Component{\n\n  constructor(props) {\n\n    super(props)\n    this.state = {\n      offset: 0,\n      pulling: false\n    }\n\n    this.__container = null\n    this.__self = null\n    this.__lastPageY = 0\n    this.__threshold = 0\n\n  }\n\n  componentDidMount() {\n\n    this.__container = document.querySelector(this.props.container) || this.refs.content.parentNode\n    this.__self = this.refs.content\n    this.__threshold = this.props.threshold || 200\n    this.__sensitivity = this.props.sensitivity || .4\n\n  }\n\n  render() {\n\n    return (\n      <div\n        ref=\"content\"\n        id={this.props.id || 'react-pulldown'}\n        className={'react-pulldown ' + this.props.class}\n        onTouchStart={(e) => this.handleTouchStart(e)}\n        onTouchMove={(e) => this.handleTouchMove(e)}\n        onTouchEnd={(e) => this.handleTouchEnd(e)}\n        style={{\n          minHeight: this.props.minHeight || '100%', \n          WebkitTransition: this.state.pulling ? 'none' : 'transform .3s',\n          WebkitTransform: 'translateZ(0) translateY(' + this.state.offset / (1 / this.__sensitivity) + 'px)',\n          transition: this.state.pulling ? 'none' : 'transform .3s',\n          transform: 'translateZ(0)  translateY(' + this.state.offset / (1 / this.__sensitivity) + 'px)'\n        }}\n        >\n          <div className=\"react-pulldown-tip\">{this.props.tip}</div>\n          {this.props.children}\n        </div>\n    )\n\n  }\n\n  handlePullCancel() {\n\n    typeof this.props.onPullCancel === 'function' && this.props.onPullCancel()\n\n  }\n\n  handlePullDown() {\n\n    typeof this.props.onPullDown === 'function' && this.props.onPullDown()\n\n  }\n\n  handleTouchStart(e) {\n\n    let containerHeight = this.__container.getBoundingClientRect().height\n    let contentHeight = this.__self.getBoundingClientRect().height\n    let scrollTop = this.__container.scrollTop\n    let scrollBottom = contentHeight - containerHeight - scrollTop\nconsole.log(scrollBottom)\n    if (scrollTop > 0 || scrollBottom > 0) {\n      return\n    }\n\n    this.__lastPageY = e.touches[0].pageY\n    this.setState({\n      pulling: true\n    })\n\n  }\n\n  handleTouchEnd() {\n\n    let containerHeight = this.__container.getBoundingClientRect().height\n    let contentHeight = this.__self.getBoundingClientRect().height\n    let scrollTop = this.__container.scrollTop\n    let scrollBottom = contentHeight - containerHeight - scrollTop\n\n    if (scrollTop > 0 || scrollBottom > 0) {\n      return\n    }\n\n    console.log(this.state.offset)\n\n    if (this.state.offset < this.__threshold) {\n      this.handlePullCancel()\n    } else {\n      this.handlePullDown()\n    }\n\n    this.setState({\n      pulling: false,\n      offset: 0\n    })\n\n  }\n\n  handleTouchMove(e) {\n\n    let containerHeight = this.__container.getBoundingClientRect().height\n    let contentHeight = this.__self.getBoundingClientRect().height\n    let scrollTop = this.__container.scrollTop\n    let scrollBottom = contentHeight - containerHeight - scrollTop\n\n    if (scrollTop > 0 || scrollBottom > 0) {\n      return\n    }\n\n    let offset = e.touches[0].pageY - this.__lastPageY\n    offset < 0 && (offset = 0)\n    offset > this.__threshold && (offset = this.__threshold)\n    offset > 0 &&  e.preventDefault()\n\n    typeof this.props.onPullMove === 'function' && this.props.onPullMove(offset, this.__threshold, this.__sensitivity)\n\n    this.setState({ offset })\n\n  }\n\n}\n\nexport default PullDown"]}